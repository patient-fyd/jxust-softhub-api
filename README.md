# jxust-softhub-api å¼€å‘æŒ‡å—

[![Language](https://img.shields.io/badge/Language-Go-blue.svg)](https://go.dev)
[![Framework](https://img.shields.io/badge/Framework-GoFrame2-green.svg)](https://goframe.org)
[![Database](https://img.shields.io/badge/Database-MySQL-orange.svg)](https://www.mysql.com)

æ±Ÿè¥¿åº”ç”¨ç§‘æŠ€å­¦é™¢è½¯ä»¶åä¼šå®˜ç½‘ & åå°ç®¡ç†ç³»ç»Ÿåç«¯é¡¹ç›®

## ğŸ“Œ é¡¹ç›®ä»‹ç»

`jxust-softhub-api` æ˜¯æœ¬ç³»ç»Ÿåç«¯æ¥å£æœåŠ¡ï¼ŒåŸºäº GoFrame2 + MySQL å¼€å‘ï¼Œè´Ÿè´£ä¸º **å®˜ç½‘å‰ç«¯ï¼ˆjxust-softhub-webï¼‰** å’Œ **åå°ç®¡ç†ç³»ç»Ÿï¼ˆjxust-softhub-adminï¼‰** æä¾› RESTful APIï¼Œæ¶µç›–ç”¨æˆ·ã€æƒé™ã€æ–°é—»ã€æ´»åŠ¨ã€é¡¹ç›®ã€èµ„æºã€å®¡æ ¸ã€ç»Ÿè®¡ã€äº’åŠ¨ç­‰æ ¸å¿ƒæ¨¡å—ã€‚

åŒæ—¶æ”¯æŒä¸å·²æœ‰çš„ **C++ OJ ç³»ç»Ÿ** å’Œ **æœç´¢å¼•æ“ç³»ç»Ÿ** é›†æˆï¼Œä¿è¯ç³»ç»Ÿæ•°æ®ç»Ÿä¸€ã€æ¥å£é«˜å¯ç”¨ã€å®‰å…¨å¯é ã€‚

## ğŸ›  æŠ€æœ¯æ ˆ

- **å¼€å‘è¯­è¨€**ï¼šGo v1.18+
- **æ¡†æ¶**ï¼šGoFrame v2.x
- **æ•°æ®åº“**ï¼šMySQL
- **ç¼“å­˜**ï¼šRedis
- **é‰´æƒ**ï¼šJWT + RBAC æƒé™æ¨¡å‹
- **ORM**ï¼šGoFrame ORM
- **APIé£æ ¼**ï¼šRESTful
- **æ—¥å¿—**ï¼šGoFrame è‡ªå¸¦ g.Log + ä¸šåŠ¡å®¡è®¡æ—¥å¿—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

- Go 1.18+ 
- MySQL 5.7+
- Redis (å¯é€‰)

### 2. è·å–ä»£ç 

```bash
git clone git@github.com:patient-fyd/jxust-softhub-api.git
cd jxust-softhub-api
```

### 3. å®‰è£…ä¾èµ–

```bash
# å®‰è£…gfå·¥å…·
make cli

# å®‰è£…é¡¹ç›®ä¾èµ–
go mod tidy
```

### 4. é…ç½®æ•°æ®åº“

```bash
# å¯¼å…¥æ•°æ®åº“
mysql -uroot -p'ä½ çš„å¯†ç ' < manifest/sql/db.sql
```

ä¿®æ”¹æ•°æ®åº“é…ç½®:

```bash
# ä¿®æ”¹å¼€å‘ç¯å¢ƒé…ç½®
vi manifest/config/config.yaml

# æµ‹è¯•/ç”Ÿäº§ç¯å¢ƒ
vi manifest/config/config.test.yaml  
vi manifest/config/config.prod.yaml
```

### 5. å¼€å‘ä¸è°ƒè¯•

```bash
# çƒ­æ›´æ–°å¯åŠ¨
make run

# è®¿é—®swaggeræ–‡æ¡£
æµè§ˆå™¨è®¿é—®: http://localhost:9000/swagger
```

## ğŸ“ å·¥ç¨‹ç›®å½•è¯´æ˜

```
â”œâ”€â”€ api         # æ¥å£å®šä¹‰ï¼Œå¯¹å¤–æä¾›æœåŠ¡çš„è¾“å…¥/è¾“å‡ºæ•°æ®ç»“æ„ï¼Œè·¯ç”±å®šä¹‰ï¼Œæ•°æ®æ ¡éªŒ
â”œâ”€â”€ cmd         # é¡¹ç›®å¯åŠ¨å…¥å£
â”œâ”€â”€ hack        # é¡¹ç›®å·¥å…·è„šæœ¬
â”œâ”€â”€ internal    # å†…éƒ¨ä»£ç 
â”‚   â”œâ”€â”€ cmd        # å‘½ä»¤è¡Œ
â”‚   â”œâ”€â”€ codes      # ä¸šåŠ¡é”™è¯¯ç 
â”‚   â”œâ”€â”€ controller # æ§åˆ¶å™¨å±‚
â”‚   â”œâ”€â”€ dao        # æ•°æ®è®¿é—®å¯¹è±¡
â”‚   â”œâ”€â”€ logic      # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ model      # æ•°æ®æ¨¡å‹
â”‚   â”œâ”€â”€ service    # æœåŠ¡æ¥å£å±‚
â”œâ”€â”€ manifest    # é…ç½®æ–‡ä»¶ç›®å½•
â”œâ”€â”€ utility     # å·¥å…·ç±»
```

## âœ… åŠŸèƒ½æ¨¡å—ä¸å¼€å‘æµç¨‹

### ä¸€ã€ç”¨æˆ·ä¸æƒé™ç³»ç»Ÿ

- ç”¨æˆ·æ³¨å†Œ/ç™»å½• (JWT)
- ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- ç”¨æˆ·è§’è‰²ç®¡ç†
- æƒé™æ§åˆ¶ (RBAC)
- å‰åå°ç”¨æˆ·åˆ†ç¦»ç™»å½•

#### å¼€å‘æ­¥éª¤
1. å®šä¹‰ API æ¥å£ (`api/auth/v1/auth.go` å’Œ `api/user/v1/user.go`)
2. ç”Ÿæˆæ§åˆ¶å™¨ä»£ç  (`make ctrl`)
3. å®ç°ä¸šåŠ¡é€»è¾‘ (`internal/logic/auth` å’Œ `internal/logic/user`)
4. ç”ŸæˆæœåŠ¡æ¥å£ (`make service`)
5. åœ¨è·¯ç”±ä¸­æ³¨å†Œæ¥å£ (`internal/cmd/apiserver/apiserver.go`)

### äºŒã€æ–°é—»åŠ¨æ€

- æ–°é—»åˆ†ç±»ç®¡ç†
- æ–°é—»å†…å®¹ç®¡ç†
- æ–°é—»è¯¦æƒ…æ¥å£
- æ–°é—»æœç´¢

#### å¼€å‘æ­¥éª¤
1. å®šä¹‰ API æ¥å£ (`api/news/v1/news.go`)
2. ç”Ÿæˆæ§åˆ¶å™¨ä»£ç  (`make ctrl`)
3. å®ç°ä¸šåŠ¡é€»è¾‘ (`internal/logic/news`)
4. ç”ŸæˆæœåŠ¡æ¥å£ (`make service`)
5. åœ¨è·¯ç”±ä¸­æ³¨å†Œæ¥å£

### ä¸‰ã€æ´»åŠ¨ç®¡ç†

- æ´»åŠ¨ä¿¡æ¯ç®¡ç†
- æ´»åŠ¨è¯¦æƒ…
- æŠ¥åæ¥å£
- æŠ¥åæ•°æ®ç®¡ç†
- æŠ¥åå®¡æ ¸
- æŠ¥åçŠ¶æ€ç®¡ç†

#### å¼€å‘æ­¥éª¤
1. å®šä¹‰ API æ¥å£ (`api/activity/v1/activity.go`)
2. ç”Ÿæˆæ§åˆ¶å™¨ä»£ç  (`make ctrl`)
3. å®ç°ä¸šåŠ¡é€»è¾‘ (`internal/logic/activity`)
4. ç”ŸæˆæœåŠ¡æ¥å£ (`make service`)
5. åœ¨è·¯ç”±ä¸­æ³¨å†Œæ¥å£

### å››ã€é¡¹ç›®ç®¡ç†

- é¡¹ç›®åŸºæœ¬ä¿¡æ¯ç®¡ç†
- OJç³»ç»Ÿé›†æˆ
- æœç´¢å¼•æ“ç³»ç»Ÿé›†æˆ
- è‡ªä¸»é¡¹ç›®å±•ç¤ºæ¥å£

#### å¼€å‘æ­¥éª¤
åŒä¸Šï¼Œåˆ›å»ºå¯¹åº” API å’Œå®ç°é€»è¾‘

### äº”ã€æˆå‘˜ä¸åŠ å…¥ç®¡ç†

- æˆå‘˜ä¿¡æ¯å±•ç¤º
- æ ¸å¿ƒæˆå‘˜ç®¡ç†
- åä¼šæˆå‘˜åˆ†å±Šç®¡ç†
- å…¥ä¼šç”³è¯·åŠå®¡æ ¸

#### å¼€å‘æ­¥éª¤
åŒä¸Šï¼Œåˆ›å»ºå¯¹åº” API å’Œå®ç°é€»è¾‘

### å…­ã€èµ„æºç®¡ç†

- èµ„æºåˆ†ç±»ç®¡ç†
- æ–‡ä»¶ä¸Šä¼ /ä¸‹è½½æ¥å£
- å¤šåª’ä½“æ–‡ä»¶æ”¯æŒ

#### å¼€å‘æ­¥éª¤
åŒä¸Šï¼Œåˆ›å»ºå¯¹åº” API å’Œå®ç°é€»è¾‘

### ä¸ƒã€è¯„è®º & æ¶ˆæ¯ç³»ç»Ÿ

- æ–°é—» & æ´»åŠ¨è¯„è®º
- ç”¨æˆ·ç§ä¿¡
- é€šçŸ¥ä¸­å¿ƒ
- å†…å®¹å®¡æ ¸æœºåˆ¶

#### å¼€å‘æ­¥éª¤
åŒä¸Šï¼Œåˆ›å»ºå¯¹åº” API å’Œå®ç°é€»è¾‘

### å…«ã€ç»Ÿè®¡åˆ†æ

- ç½‘ç«™è®¿é—®ç»Ÿè®¡
- æ´»åŠ¨æŠ¥åæ•°æ®ç»Ÿè®¡
- ç”¨æˆ·æ´»è·ƒåº¦ç»Ÿè®¡
- æ•°æ®å¯è§†åŒ–æ¥å£

#### å¼€å‘æ­¥éª¤
åŒä¸Šï¼Œåˆ›å»ºå¯¹åº” API å’Œå®ç°é€»è¾‘

### ä¹ã€æ—¥å¿—ç³»ç»Ÿ

- æ“ä½œæ—¥å¿—
- å®¡è®¡æ—¥å¿—
- å…³é”®æ“ä½œæŠ¥è­¦

#### å¼€å‘æ­¥éª¤
åŒä¸Šï¼Œåˆ›å»ºå¯¹åº” API å’Œå®ç°é€»è¾‘

## ğŸ“˜ å¼€å‘è§„èŒƒ

### API æ¥å£è§„èŒƒ

- æ‰€æœ‰æ¥å£éµå¾ª RESTful é£æ ¼
- ç»Ÿä¸€è¿”å›æ ¼å¼ï¼š`code` + `message` + `traceid` + `data`
- æ‰€æœ‰æ¥å£éœ€æ”¯æŒ JWT é‰´æƒå’Œæƒé™æ ¡éªŒ
- ç®¡ç†ç«¯æ¥å£æŒ‰è§’è‰²ä¸¥æ ¼æ§åˆ¶æƒé™

### ç›®å½•å‘½åè§„èŒƒ

- æ¨¡å—åä½¿ç”¨å•æ•°ï¼Œå¦‚ `user` è€Œé `users`
- API ç‰ˆæœ¬æ§åˆ¶ï¼š`api/æ¨¡å—åç§°/v1/æ¨¡å—åç§°.go`
- æ§åˆ¶å™¨ï¼š`internal/controller/æ¨¡å—åç§°/`
- ä¸šåŠ¡é€»è¾‘ï¼š`internal/logic/æ¨¡å—åç§°/`

### å¼€å‘æµç¨‹æ€»ç»“

1. è®¾è®¡è¡¨ç»“æ„ï¼Œåˆ›å»ºç‰©ç†è¡¨ (å·²å®Œæˆ)
2. è‡ªåŠ¨ç”Ÿæˆæ•°æ®å±‚ä»£ç  (`make dao`)
3. ç¼–å†™ API å±‚ä»£ç  (æ•°æ®ç»“æ„ã€æ¥å£å®šä¹‰)
4. ç”Ÿæˆæ§åˆ¶å™¨å±‚ä»£ç  (`make ctrl`)
5. ç¼–å†™ Model å±‚ä»£ç  (å†…éƒ¨æ•°æ®ç»“æ„)
6. ç¼–å†™ Service å±‚ä»£ç  (ä¸šåŠ¡å®ç°)
7. ç”ŸæˆæœåŠ¡æ¥å£ (`make service`)
8. è·¯ç”±æ³¨å†Œ
9. æ¥å£æµ‹è¯•

## ğŸª„ ç‰ˆæœ¬ç®¡ç†è§„èŒƒ

### åˆ†æ”¯ç®¡ç† (Gitflow)

| åˆ†æ”¯      | è¯´æ˜         |
| --------- | ------------ |
| main      | æ­£å¼çº¿ä¸Šåˆ†æ”¯ |
| develop   | æ—¥å¸¸å¼€å‘åˆ†æ”¯ |
| feature/* | åŠŸèƒ½å¼€å‘åˆ†æ”¯ |
| fix/*     | bug ä¿®å¤åˆ†æ”¯ |
| hotfix/*  | ç´§æ€¥ä¿®å¤åˆ†æ”¯ |
| release/* | ç‰ˆæœ¬å‘å¸ƒåˆ†æ”¯ |

### Commit è§„èŒƒ

| ç±»å‹     | è¯´æ˜                     |
| -------- | ------------------------ |
| feat     | æ–°å¢æ¥å£/åŠŸèƒ½           |
| fix      | ä¿®å¤ Bug                 |
| refactor | é‡æ„ä»£ç ï¼Œä¸å½±å“æ¥å£     |
| style    | ä»£ç é£æ ¼/æ ¼å¼åŒ–          |
| chore    | æ„å»ºã€è„šæœ¬ã€CI/CD        |
| docs     | æ–‡æ¡£æ›´æ–°                 |
| test     | å•å…ƒæµ‹è¯•                 |

#### Commit ç¤ºä¾‹

```
feat: å®Œæˆç”¨æˆ·æ³¨å†Œæ¥å£
fix: ä¿®å¤ JWT Token åˆ·æ–°å¼‚å¸¸
refactor: é‡æ„æŠ¥åç»Ÿè®¡æ¥å£
docs: æ·»åŠ æ´»åŠ¨æŠ¥åæ¥å£æ–‡æ¡£
```

## ğŸ”§ å¸¸ç”¨å‘½ä»¤

```bash
# å®‰è£… gf å·¥å…·
make cli

# ç”Ÿæˆ dao å±‚ä»£ç 
make dao

# ç”Ÿæˆæ§åˆ¶å™¨ä»£ç 
make ctrl

# ç”ŸæˆæœåŠ¡æ¥å£ä»£ç 
make service

# çƒ­æ›´æ–°å¯åŠ¨å¼€å‘ç¯å¢ƒ
make run

# ç¼–è¯‘ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶
make build

# è¿è¡Œä»£ç æ£€æŸ¥
make lint
```

## ğŸ“ æ³¨æ„äº‹é¡¹

- ä¸è¦ç›´æ¥ä¿®æ”¹ `internal/dao`ã€`internal/model/do`ã€`internal/model/entity` ç›®å½•ä¸‹çš„ä»£ç ï¼Œè¿™äº›æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„
- ä¸è¦ä¿®æ”¹ `internal/controller/*/xxx_new.go` æ–‡ä»¶ï¼Œè¿™æ˜¯è‡ªåŠ¨ç”Ÿæˆçš„æ§åˆ¶å™¨åˆå§‹åŒ–ä»£ç 
- å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼ŒæŒ‰ç…§GoFrame2æ¡†æ¶è§„èŒƒåˆ›å»ºå¯¹åº”çš„æ¨¡å—ç»“æ„
- æ¥å£å¼€å‘æ—¶ï¼Œä¿æŒå‰åç«¯æ¥å£é£æ ¼ç»Ÿä¸€
- æ¨èä½¿ç”¨ Swagger æˆ– Apifox ç»´æŠ¤æ¥å£æ–‡æ¡£
- æ¨èä½¿ç”¨ GoFrame2 å†…ç½®ä¸­é—´ä»¶ï¼ˆæƒé™ã€é™æµã€æ—¥å¿—ï¼‰+ è‡ªå®šä¹‰æ‰©å±•

## ğŸ“š å‚è€ƒé“¾æ¥

- [GoFrame å®˜æ–¹æ–‡æ¡£](https://goframe.org)
- [JWT è®¤è¯](https://goframe.org/pages/viewpage.action?pageId=1114217)
- [GoFrame ORM](https://goframe.org/pages/viewpage.action?pageId=1114245)
- [é”™è¯¯å¤„ç†](https://goframe.org/pages/viewpage.action?pageId=1114399)

## å¼€å‘æ­¥éª¤

1. ç¡®ä¿å¼€å‘ç¯å¢ƒå·²æ­£ç¡®è®¾ç½®ï¼Œæ‰€æœ‰ä¾èµ–éƒ½å·²å®‰è£…
2. ç†è§£é¡¹ç›®æ¶æ„å’Œç›®å½•ç»“æ„
3. ä½¿ç”¨GoFrame2æ¡†æ¶çš„è§„èŒƒå’Œæ¨¡å¼å¼€å‘æ–°åŠŸèƒ½
4. å¼€å‘æ–°åŠŸèƒ½æ—¶ï¼Œéµå¾ªé¡¹ç›®ä¸­å®šä¹‰çš„è®¾è®¡æ¨¡å¼å’Œä»£ç è§„èŒƒ
